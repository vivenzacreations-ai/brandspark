<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Norex Studio - Your Digital Partner</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        neon: {
                            pink: '#FF1CC0',
                            purple: '#B131FA',
                            deep: '#4A0074',
                            blue: '#1C3AFF',
                            midnight: '#090014',
                            dark: '#18002b',
                            card: '#240040'
                        }
                    },
                    fontFamily: {
                        sans: ['SF Pro Display', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @font-face { font-family: "SF Pro Display"; font-style: normal; font-weight: 400; src: url("https://raw.githubusercontent.com/blaisck/sfwin/master/SFPro/TrueType/SFProDisplay-Regular.ttf"); }
        @font-face { font-family: "SF Pro Display"; font-style: normal; font-weight: 600; src: url("https://raw.githubusercontent.com/blaisck/sfwin/master/SFPro/TrueType/SFProDisplay-SemiBold.ttf"); }
        @font-face { font-family: "SF Pro Display"; font-style: normal; font-weight: 700; src: url("https://raw.githubusercontent.com/blaisck/sfwin/master/SFPro/TrueType/SFProDisplay-Bold.ttf"); }

        body {
            font-family: 'SF Pro Display', sans-serif;
            background-color: #090014;
        }
        .hero-bg {
            background-color: #090014;
            background-image: 
                radial-gradient(circle at 50% 20%, rgba(74, 0, 116, 0.4) 0%, transparent 60%),
                radial-gradient(circle at 50% 50%, #120024 0%, #090014 100%);
        }
        .glow-button:hover {
            box-shadow: 0 0 20px 5px rgba(255, 28, 192, 0.5);
        }
        .glow-element:hover {
             box-shadow: 0 0 20px 8px rgba(28, 58, 255, 0.4);
             border-color: #B131FA;
        }
        .glassy-menu-button {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(9px) saturate(180%);
            -webkit-backdrop-filter: blur(9px) saturate(180%);
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            border-radius: 9999px;
            padding: 0.75rem;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            cursor: pointer;
        }
        
        /* === MODIFIED HEADER CSS === */
        /* Removed the CSS filter effects to let JS handle the liquid distortion */
        .liquid-glass-header {
            /* Base opacity for the glass layer (visual fallback) */
            background: rgba(255, 255, 255, 0.05);
            /* Crisp border */
            border: 1px solid rgba(255, 255, 255, 0.2);
            /* Shadows for depth */
            box-shadow: inset 0px 4px 30px rgba(0, 0, 0, 0.1),
                        0px 10px 40px rgba(0, 0, 0, 0.5);
            /* Transition for smooth resizing */
            transition: backdrop-filter 0.3s ease;
        }

        /* === ANIMATED MENU DIVIDERS === */
        @keyframes shimmer {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }
        .menu-divider {
            height: 1px;
            width: 100%;
            background: linear-gradient(90deg, transparent, #B131FA, transparent);
            background-size: 200% 100%;
            animation: shimmer 3s infinite linear;
            opacity: 1;
        }
        
        .portfolio-overlay {
            background: linear-gradient(to top, rgba(9, 0, 20, 0.95), rgba(9, 0, 20, 0.6), transparent);
        }
    </style>
</head>
<body class="bg-neon-midnight text-gray-200 selection:bg-neon-pink selection:text-white overflow-x-hidden">

    <!-- MOBILE MENU OVERLAY & MENU -->
    <div id="mobile-menu-overlay" class="fixed inset-0 bg-black/90 backdrop-blur-md z-[60] hidden transition-opacity duration-300"></div>

    <div id="mobile-menu" class="hidden md:hidden fixed inset-x-4 top-24 max-w-lg mx-auto bg-neon-dark/95 backdrop-blur-xl rounded-[2rem] z-[70] border border-neon-deep overflow-hidden shadow-2xl shadow-neon-deep/50 transition-all duration-300">
        <div class="flex justify-between items-center p-6 bg-white/5">
            <span class="text-xl font-bold text-white tracking-wider ml-2">Menu</span>
            <button id="mobile-menu-close-button" class="focus:outline-none glassy-menu-button w-10 h-10 hover:bg-red-500/20 hover:border-red-500/50">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <div class="menu-divider"></div>

        <div class="flex flex-col p-2">
            <a href="#home" class="block text-center py-4 text-lg font-medium hover:bg-neon-pink/10 hover:text-neon-pink transition rounded-xl">Home</a>
            <div class="menu-divider opacity-30"></div>
            
            <a href="#about" class="block text-center py-4 text-lg font-medium hover:bg-neon-pink/10 hover:text-neon-pink transition rounded-xl">About</a>
            <div class="menu-divider opacity-30"></div>

            <a href="#services" class="block text-center py-4 text-lg font-medium hover:bg-neon-pink/10 hover:text-neon-pink transition rounded-xl">Services</a>
            <div class="menu-divider opacity-30"></div>

            <a href="#portfolio" class="block text-center py-4 text-lg font-medium hover:bg-neon-pink/10 hover:text-neon-pink transition rounded-xl">Portfolio</a>
            <div class="menu-divider opacity-30"></div>

            <a href="#testimonials" class="block text-center py-4 text-lg font-medium hover:bg-neon-pink/10 hover:text-neon-pink transition rounded-xl">Testimonials</a>
            <div class="menu-divider opacity-30"></div>

            <a href="#contact" class="block text-center py-4 text-lg font-bold text-neon-pink hover:bg-neon-pink/10 transition rounded-xl mt-2 mb-2">Contact Us</a>
        </div>
    </div>

    <!-- HEADER SECTION -->
    <div class="sticky top-0 z-50 p-2 md:p-4">
        <!-- Added ID for JS targeting -->
        <header id="header" class="container mx-auto relative rounded-full liquid-glass-header transition-all duration-300">
            <div class="relative z-10 w-full flex justify-between items-center px-6 py-3 md:px-10 md:py-4">
                <a href="#home" class="flex items-center text-2xl md:text-3xl font-bold text-white tracking-wider group">
                    <svg class="h-8 w-8 md:h-9 md:w-9 text-cyan-400 mr-3 group-hover:scale-110 transition-transform" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
                    </svg>
                    Norex Studio
                </a>
                <nav class="hidden md:flex space-x-10">
                    <a href="#home" class="text-lg font-medium text-gray-300 hover:text-neon-pink transition duration-300">Home</a>
                    <a href="#about" class="text-lg font-medium text-gray-300 hover:text-neon-pink transition duration-300">About</a>
                    <a href="#services" class="text-lg font-medium text-gray-300 hover:text-neon-pink transition duration-300">Services</a>
                    <a href="#portfolio" class="text-lg font-medium text-gray-300 hover:text-neon-pink transition duration-300">Portfolio</a>
                    <a href="#testimonials" class="text-lg font-medium text-gray-300 hover:text-neon-pink transition duration-300">Testimonials</a>
                    <a href="#contact" class="text-lg font-medium text-gray-300 hover:text-neon-pink transition duration-300">Contact</a>
                </nav>
                <button id="mobile-menu-button" class="md:hidden focus:outline-none z-50 glassy-menu-button hover:text-neon-pink transition-colors">
                    <i id="menu-open-icon" class="fas fa-bars fa-lg"></i>
                </button>
            </div>
        </header>
    </div>

    <main>
        <!-- HERO SECTION -->
        <section id="home" class="hero-bg min-h-screen flex items-center relative overflow-hidden">
            <img src="https://images.unsplash.com/photo-1531297484001-80022131f5a1?q=80&w=1920&auto-format&fit=crop"
                 alt="Background Tech"
                 class="absolute inset-0 w-full h-full object-cover opacity-10 mix-blend-color-dodge">
            
            <div class="absolute inset-0 bg-gradient-to-b from-neon-deep/30 via-neon-midnight/80 to-neon-midnight"></div>

            <div class="container mx-auto px-6 text-center relative z-10 pt-20">
                <h1 class="text-4xl md:text-6xl font-extrabold text-white leading-tight mb-4 drop-shadow-lg">Crafting Digital Experiences That <span class="text-neon-pink">Inspire</span></h1>
                <p class="text-lg md:text-xl text-gray-300 mb-8 max-w-3xl mx-auto leading-relaxed">We are a creative agency that builds beautiful and effective websites, apps, and brands.</p>
                <a href="#contact" class="bg-neon-pink text-white font-semibold px-8 py-3 rounded-full hover:bg-fuchsia-500 transition duration-300 text-lg glow-button inline-block">Let's Get Started</a>
            </div>
        </section>

        <!-- ABOUT SECTION -->
        <section id="about" class="py-20 bg-neon-dark relative border-t border-neon-deep/30">
            <div class="container mx-auto px-6">
                <div class="text-center mb-12">
                    <h2 class="text-3xl md:text-4xl font-bold text-white">About Us</h2>
                    <div class="w-24 h-1 bg-neon-blue mx-auto mt-4 rounded box-shadow-[0_0_10px_#1C3AFF]"></div>
                </div>
                <div class="flex flex-col md:flex-row items-center gap-12">
                    <div class="md:w-1/2 relative group">
                        <div class="absolute -inset-1 bg-gradient-to-r from-neon-pink to-neon-blue rounded-[3rem] blur opacity-25 group-hover:opacity-75 transition duration-1000 group-hover:duration-200"></div>
                        <img src="https://images.unsplash.com/photo-1522071820081-009f0129c71c?q=80&w=1920&auto-format&fit=crop" alt="Team" class="relative rounded-[3rem] shadow-2xl w-full border border-gray-800">
                    </div>
                    <div class="md:w-1/2 text-center md:text-left">
                        <h3 class="text-2xl font-semibold text-white mb-4">Who We Are</h3>
                        <p class="text-gray-300 text-base md:text-lg leading-relaxed mb-4">Norex Studio is a passionate team of designers, developers, and strategists dedicated to helping businesses succeed in the digital world. We believe in the power of great design and smart technology.</p>
                        <p class="text-gray-300 text-base md:text-lg leading-relaxed">Our mission is to deliver innovative and results-driven digital solutions that empower our clients to achieve their goals.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- SERVICES SECTION -->
        <section id="services" class="py-20 bg-neon-midnight relative overflow-hidden">
            <div class="absolute top-0 right-0 -mr-20 -mt-20 w-96 h-96 bg-neon-deep opacity-20 blur-3xl rounded-full pointer-events-none"></div>

            <div class="container mx-auto px-6 relative z-10">
                <div class="text-center mb-12">
                    <h2 class="text-3xl md:text-4xl font-bold text-white">Our Services</h2>
                    <div class="w-24 h-1 bg-neon-pink mx-auto mt-4 rounded"></div>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                    <div class="bg-neon-card border border-neon-deep/50 p-8 rounded-[3rem] text-center shadow-lg transform hover:-translate-y-2 transition-all duration-300 glow-element group">
                        <div class="text-neon-blue mb-4 group-hover:text-neon-pink transition-colors duration-300"><i class="fas fa-laptop-code fa-3x"></i></div>
                        <h3 class="text-xl font-bold text-white mb-2">Web Development</h3>
                        <p class="text-gray-400 text-base md:text-lg">We build fast, responsive, and secure websites tailored to your business needs.</p>
                    </div>

                    <div class="bg-neon-card border border-neon-deep/50 p-8 rounded-[3rem] text-center shadow-lg transform hover:-translate-y-2 transition-all duration-300 glow-element group">
                        <div class="text-neon-blue mb-4 group-hover:text-neon-pink transition-colors duration-300"><i class="fas fa-paint-brush fa-3x"></i></div>
                        <h3 class="text-xl font-bold text-white mb-2">UI/UX Design</h3>
                        <p class="text-gray-400 text-base md:text-lg">Creating intuitive and visually stunning interfaces for an exceptional user experience.</p>
                    </div>

                    <div class="bg-neon-card border border-neon-deep/50 p-8 rounded-[3rem] text-center shadow-lg transform hover:-translate-y-2 transition-all duration-300 glow-element group">
                        <div class="text-neon-blue mb-4 group-hover:text-neon-pink transition-colors duration-300"><i class="fas fa-chart-line fa-3x"></i></div>
                        <h3 class="text-xl font-bold text-white mb-2">Digital Marketing</h3>
                        <p class="text-gray-400 text-base md:text-lg">Boosting your online presence and driving growth with strategic marketing campaigns.</p>
                    </div>

                    <div class="bg-neon-card border border-neon-deep/50 p-8 rounded-[3rem] text-center shadow-lg transform hover:-translate-y-2 transition-all duration-300 glow-element group">
                        <div class="text-neon-blue mb-4 group-hover:text-neon-pink transition-colors duration-300"><i class="fas fa-bullhorn fa-3x"></i></div>
                        <h3 class="text-xl font-bold text-white mb-2">SEO Optimization</h3>
                        <p class="text-gray-400 text-base md:text-lg">Improving your search engine rankings to attract more organic traffic.</p>
                    </div>

                    <div class="bg-neon-card border border-neon-deep/50 p-8 rounded-[3rem] text-center shadow-lg transform hover:-translate-y-2 transition-all duration-300 glow-element group">
                        <div class="text-neon-blue mb-4 group-hover:text-neon-pink transition-colors duration-300"><i class="fas fa-mobile-alt fa-3x"></i></div>
                        <h3 class="text-xl font-bold text-white mb-2">App Development</h3>
                        <p class="text-gray-400 text-base md:text-lg">Building native and cross-platform mobile apps that users love.</p>
                    </div>

                    <div class="bg-neon-card border border-neon-deep/50 p-8 rounded-[3rem] text-center shadow-lg transform hover:-translate-y-2 transition-all duration-300 glow-element group">
                        <div class="text-neon-blue mb-4 group-hover:text-neon-pink transition-colors duration-300"><i class="fas fa-copyright fa-3x"></i></div>
                        <h3 class="text-xl font-bold text-white mb-2">Branding</h3>
                        <p class="text-gray-400 text-base md:text-lg">Developing a strong brand identity that resonates with your target audience.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- PORTFOLIO SECTION -->
        <section id="portfolio" class="py-20 bg-neon-dark relative border-t border-neon-deep/30">
            <div class="container mx-auto px-6">
                 <div class="text-center mb-12">
                    <h2 class="text-3xl md:text-4xl font-bold text-white">Portfolio</h2>
                    <div class="w-24 h-1 bg-neon-blue mx-auto mt-4 rounded box-shadow-[0_0_10px_#1C3AFF]"></div>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <!-- Project 1 -->
                    <div class="group relative h-80 rounded-[2.5rem] overflow-hidden cursor-pointer border border-neon-deep/30">
                        <img src="https://images.unsplash.com/photo-1481487484168-9b930d552086?q=80&w=1920&auto-format&fit=crop" loading="lazy" alt="Project 1" class="absolute inset-0 w-full h-full object-cover transition-transform duration-700 group-hover:scale-110">
                        <div class="absolute inset-0 portfolio-overlay opacity-80 group-hover:opacity-90 transition-opacity"></div>
                        <div class="absolute bottom-0 left-0 p-8 transform translate-y-4 group-hover:translate-y-0 transition-transform duration-300">
                            <span class="text-neon-pink font-bold uppercase text-xs tracking-wider">Web Design</span>
                            <h3 class="text-2xl font-bold text-white mt-1">Neon Horizons</h3>
                        </div>
                    </div>
                    <!-- Project 2 -->
                    <div class="group relative h-80 rounded-[2.5rem] overflow-hidden cursor-pointer border border-neon-deep/30">
                        <img src="https://images.unsplash.com/photo-1550745165-9bc0b252726f?q=80&w=1920&auto-format&fit=crop" loading="lazy" alt="Project 2" class="absolute inset-0 w-full h-full object-cover transition-transform duration-700 group-hover:scale-110">
                        <div class="absolute inset-0 portfolio-overlay opacity-80 group-hover:opacity-90 transition-opacity"></div>
                        <div class="absolute bottom-0 left-0 p-8 transform translate-y-4 group-hover:translate-y-0 transition-transform duration-300">
                            <span class="text-neon-blue font-bold uppercase text-xs tracking-wider">App Development</span>
                            <h3 class="text-2xl font-bold text-white mt-1">Cyber Wallet</h3>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- TESTIMONIALS SECTION -->
        <section id="testimonials" class="py-20 bg-neon-midnight relative border-t border-neon-deep/30">
             <div class="container mx-auto px-6">
                 <div class="text-center mb-12">
                    <h2 class="text-3xl md:text-4xl font-bold text-white">Testimonials</h2>
                    <div class="w-24 h-1 bg-neon-pink mx-auto mt-4 rounded"></div>
                </div>
                 <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                     <div class="p-8 rounded-[2rem] bg-neon-card border border-neon-deep/50 relative">
                        <p class="text-gray-300 italic mb-6">"Norex Studio transformed our digital presence completely. Highly recommended!"</p>
                        <h4 class="font-bold text-white">Jane Doe</h4>
                        <p class="text-sm text-neon-blue">CEO, TechFlow</p>
                    </div>
                    <div class="p-8 rounded-[2rem] bg-neon-card border border-neon-deep/50 relative">
                        <p class="text-gray-300 italic mb-6">"Incredible attention to detail and futuristic designs that really pop."</p>
                        <h4 class="font-bold text-white">John Smith</h4>
                        <p class="text-sm text-neon-pink">Founder, StartupX</p>
                    </div>
                    <div class="p-8 rounded-[2rem] bg-neon-card border border-neon-deep/50 relative">
                        <p class="text-gray-300 italic mb-6">"Professional, fast, and creatively unmatched. A joy to work with."</p>
                        <h4 class="font-bold text-white">Sarah Lee</h4>
                        <p class="text-sm text-neon-purple">Director, CreativeCo</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- CONTACT SECTION -->
        <section id="contact" class="py-20 bg-neon-dark relative border-t border-neon-deep/30">
             <div class="container mx-auto px-6 text-center">
                 <h2 class="text-3xl md:text-4xl font-bold text-white mb-6">Get In Touch</h2>
                 <p class="text-gray-300 mb-8 max-w-2xl mx-auto">Ready to start your next project? Contact us today.</p>
                 <a href="mailto:hello@norexstudio.com" class="bg-neon-blue text-white font-semibold px-8 py-3 rounded-full hover:bg-blue-600 transition duration-300 text-lg glow-button inline-block">Contact Us</a>
             </div>
        </section>
    </main>

    <footer class="bg-neon-midnight border-t border-neon-deep">
        <div class="container mx-auto px-6 py-8">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <p class="text-gray-400 text-base">&copy; 2025 Norex Studio. All Rights Reserved.</p>
                <div class="flex space-x-6 mt-4 md:mt-0">
                    <a href="#" class="text-gray-400 hover:text-neon-pink transition"><i class="fab fa-twitter fa-lg"></i></a>
                    <a href="#" class="text-gray-400 hover:text-neon-pink transition"><i class="fab fa-linkedin-in fa-lg"></i></a>
                    <a href="#" class="text-gray-400 hover:text-neon-pink transition"><i class="fab fa-github fa-lg"></i></a>
                </div>
            </div>
        </div>
    </footer>
    
    <script>
        // --- Mobile menu toggle ---
        const mobileMenuButton = document.getElementById('mobile-menu-button');
        const mobileMenuCloseButton = document.getElementById('mobile-menu-close-button');
        const mobileMenu = document.getElementById('mobile-menu');
        const mobileMenuOverlay = document.getElementById('mobile-menu-overlay');
        const mobileMenuLinks = mobileMenu.querySelectorAll('a');

        const toggleMenu = () => {
            const isHidden = mobileMenu.classList.contains('hidden');
            if (isHidden) {
                mobileMenu.classList.remove('hidden');
                mobileMenuOverlay.classList.remove('hidden');
            } else {
                mobileMenu.classList.add('hidden');
                mobileMenuOverlay.classList.add('hidden');
            }
        };

        if(mobileMenuButton) mobileMenuButton.addEventListener('click', toggleMenu);
        if(mobileMenuCloseButton) mobileMenuCloseButton.addEventListener('click', toggleMenu);
        
        mobileMenuLinks.forEach(link => {
            link.addEventListener('click', () => {
                if (!mobileMenu.classList.contains('hidden')) {
                    toggleMenu();
                }
            });
        });

        if(mobileMenuOverlay) mobileMenuOverlay.addEventListener('click', toggleMenu);

        // --- LIQUID GLASS INTEGRATION ---
        (function() {
          'use strict';
          
          if (window.liquidGlass) {
            window.liquidGlass.destroy();
          }
          
          function smoothStep(a, b, t) {
            t = Math.max(0, Math.min(1, (t - a) / (b - a)));
            return t * t * (3 - 2 * t);
          }

          function length(x, y) {
            return Math.sqrt(x * x + y * y);
          }

          function roundedRectSDF(x, y, width, height, radius) {
            const qx = Math.abs(x) - width + radius;
            const qy = Math.abs(y) - height + radius;
            return Math.min(Math.max(qx, qy), 0) + length(Math.max(qx, 0), Math.max(qy, 0)) - radius;
          }

          function texture(x, y) {
            return { type: 't', x, y };
          }

          function generateId() {
            return 'liquid-glass-' + Math.random().toString(36).substr(2, 9);
          }

          class Shader {
            constructor(options = {}) {
              // Target the specific element provided or fallback
              this.targetElement = options.targetElement || document.body;
              
              // Initial dimensions from target
              this.width = this.targetElement.offsetWidth;
              this.height = this.targetElement.offsetHeight;
              
              this.fragment = options.fragment || ((uv) => texture(uv.x, uv.y));
              this.canvasDPI = 1; // Keep 1 for performance on large headers
              this.id = generateId();
              
              // No offset/dragging logic needed for fixed header integration
              
              this.mouse = { x: 0, y: 0 };
              this.mouseUsed = false;
              
              this.initElement();
              this.setupObservers();
              this.updateShader();
            }

            initElement() {
              // Apply styles to EXISTING target element instead of creating new div
              // MODIFIED: blur set to 0px
              this.targetElement.style.backdropFilter = `url(#${this.id}_filter) blur(0px) brightness(1.1)`;
              this.targetElement.style.webkitBackdropFilter = `url(#${this.id}_filter) blur(0px) brightness(1.1)`;

              // Create SVG filter system
              this.svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
              this.svg.setAttribute('xmlns', 'http://www.w3.org/2000/svg');
              this.svg.style.cssText = 'position: absolute; width: 0; height: 0; pointer-events: none;';

              const defs = document.createElementNS('http://www.w3.org/2000/svg', 'defs');
              const filter = document.createElementNS('http://www.w3.org/2000/svg', 'filter');
              filter.setAttribute('id', `${this.id}_filter`);
              filter.setAttribute('filterUnits', 'userSpaceOnUse'); // Important for mapping to element size
              filter.setAttribute('colorInterpolationFilters', 'sRGB');
              filter.setAttribute('x', '0');
              filter.setAttribute('y', '0');
              filter.setAttribute('width', '100%');
              filter.setAttribute('height', '100%');

              this.feImage = document.createElementNS('http://www.w3.org/2000/svg', 'feImage');
              this.feImage.setAttribute('id', `${this.id}_map`);
              // Use percentage to ensure it stretches with container
              this.feImage.setAttribute('width', '100%'); 
              this.feImage.setAttribute('height', '100%');
              this.feImage.setAttribute('preserveAspectRatio', 'none');

              this.feDisplacementMap = document.createElementNS('http://www.w3.org/2000/svg', 'feDisplacementMap');
              this.feDisplacementMap.setAttribute('in', 'SourceGraphic');
              this.feDisplacementMap.setAttribute('in2', `${this.id}_map`);
              this.feDisplacementMap.setAttribute('scale', '30'); // Intensity of glass effect
              this.feDisplacementMap.setAttribute('xChannelSelector', 'R');
              this.feDisplacementMap.setAttribute('yChannelSelector', 'G');

              filter.appendChild(this.feImage);
              filter.appendChild(this.feDisplacementMap);
              defs.appendChild(filter);
              this.svg.appendChild(defs);

              // Canvas for generating the displacement map texture
              this.canvas = document.createElement('canvas');
              this.canvas.width = this.width;
              this.canvas.height = this.height;
              
              this.context = this.canvas.getContext('2d');
              
              document.body.appendChild(this.svg);
            }

            setupObservers() {
               // Resize Observer to handle window resizing
               this.resizeObserver = new ResizeObserver(entries => {
                   for (let entry of entries) {
                       const { width, height } = entry.contentRect;
                       this.width = width;
                       this.height = height;
                       this.canvas.width = width;
                       this.canvas.height = height;
                       this.updateShader();
                   }
               });
               this.resizeObserver.observe(this.targetElement);

              // Basic mouse tracking for potential interactive effects
              document.addEventListener('mousemove', (e) => {
                const rect = this.targetElement.getBoundingClientRect();
                this.mouse.x = (e.clientX - rect.left) / rect.width;
                this.mouse.y = (e.clientY - rect.top) / rect.height;
                // Only update if mouse is near/over header to save performance
                if (this.mouseUsed && e.clientY < rect.bottom + 100) {
                  this.updateShader();
                }
              });
            }

            updateShader() {
              const w = this.width;
              const h = this.height;
              // If size is 0 (hidden), skip
              if (w === 0 || h === 0) return;

              const data = new Uint8ClampedArray(w * h * 4);
              let maxScale = 0;
              const rawValues = [];

              // We calculate aspect ratio to pass to SDF
              const aspect = w / h;

              // Optimization: Render at lower resolution if needed, but 1:1 is best for glass
              // Loop through pixels
              for (let i = 0; i < data.length; i += 4) {
                const idx = i / 4;
                const x = idx % w;
                const y = Math.floor(idx / w);
                
                // Normalized UV coordinates (0 to 1)
                const uvX = x / w;
                const uvY = y / h;

                const pos = this.fragment(
                  { x: uvX, y: uvY },
                  this.mouse,
                  aspect 
                );

                const dx = pos.x * w - x;
                const dy = pos.y * h - y;
                maxScale = Math.max(maxScale, Math.abs(dx), Math.abs(dy));
                rawValues.push(dx, dy);
              }

              maxScale = Math.max(maxScale, 0.1) * 0.5; // Prevent divide by zero

              let index = 0;
              for (let i = 0; i < data.length; i += 4) {
                const r = rawValues[index++] / maxScale + 0.5;
                const g = rawValues[index++] / maxScale + 0.5;
                data[i] = Math.min(255, Math.max(0, r * 255));
                data[i + 1] = Math.min(255, Math.max(0, g * 255));
                data[i + 2] = 0;
                data[i + 3] = 255;
              }

              this.context.putImageData(new ImageData(data, w, h), 0, 0);
              
              // Apply generated map to SVG
              this.feImage.setAttributeNS('http://www.w3.org/1999/xlink', 'href', this.canvas.toDataURL());
              // Update displacement scale if dynamic
              // this.feDisplacementMap.setAttribute('scale', maxScale.toString()); 
            }

            destroy() {
              if(this.resizeObserver) this.resizeObserver.disconnect();
              this.svg.remove();
              this.targetElement.style.backdropFilter = '';
              this.targetElement.style.webkitBackdropFilter = '';
            }
          }

          function createLiquidGlass() {
            const headerElement = document.getElementById('header');
            if(!headerElement) return;

            const shader = new Shader({
              targetElement: headerElement,
              fragment: (uv, mouse, aspect) => {
                // Center coordinates (-0.5 to 0.5)
                const ix = uv.x - 0.5;
                const iy = uv.y - 0.5;
                
                // Adjust for Aspect Ratio so physics don't stretch weirdly
                // We want a capsule shape (rounded rectangle) that matches the header
                // Header is roughly width=1.0 (relative), height=1.0 (relative) in UV
                
                // We want the glass curve to be near the edges.
                // We create a rounded rect that is slightly smaller than the container 
                // to create the "beveled edge" effect.
                
                const distanceToEdge = roundedRectSDF(
                  ix, 
                  iy, 
                  0.48, // Width (almost full width of 0.5)
                  0.45, // Height (almost full height of 0.5)
                  0.1   // Corner radius
                );
                
                // This curve creates the glass refraction profile
                const displacement = smoothStep(0.2, 0, distanceToEdge); 
                const scaled = smoothStep(0, 1, displacement);
                
                // Apply slight distortion based on the calculated curve
                return texture(ix * scaled + 0.5, iy * scaled + 0.5);
              }
            });

            window.liquidGlass = shader;
          }

          // Initialize when DOM is ready
          if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', createLiquidGlass);
          } else {
            createLiquidGlass();
          }
        })();
    </script>
</body>
</html>
